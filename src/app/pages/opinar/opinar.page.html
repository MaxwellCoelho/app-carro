<ion-content [fullscreen]="true">
  <app-loader [showLoader]="showLoader"></app-loader>

  <div class="main-container">
    <ion-title size="large" color="primary" class="main-title">
      <ion-icon [name]="'clipboard-outline'" color="secondary"></ion-icon>
      <ion-label>Opinar</ion-label>
    </ion-title>

    <div class="main-body" *ngIf="selectedModel">
      <ion-grid slot="content" class="selected-model-grid">
        <ion-row>
          <ion-col size-lg="1.5" size-md="2" size-sm="2.7" size-xs="12" class="model-logo">
            <img src="assets/brands/{{selectedModel.brand.image}}" title="{{selectedModel.brand.name}} {{selectedModel.name}}" alt="{{selectedModel.brand.name}} {{selectedModel.name}}"
              onerror="if (this.src != 'error.jpg') this.src = 'assets/brands/no-brand.svg'" class="brand-image-title">
          </ion-col>
          <ion-col size-lg="9" size-md="8" size-sm="6.7" size-xs="12" class="model-name">
            <ion-label class="brand-label-title">{{selectedModel.brand.name}} <span>{{selectedModel.name}}</span></ion-label>
          </ion-col>
          <ion-col size-lg="1.5" size-md="2" size-sm="2.6" size-xs="12" class="model-category">
            <ion-icon name="car-outline" color="medium" size="large" class="category-image"></ion-icon>
            <ion-label color="medium">{{selectedModel.category.name}}</ion-label>
          </ion-col>
        </ion-row>
      </ion-grid>

      <ion-item lines="none">
        <img src="assets/models/{{selectedModel.image}}" title="{{selectedModel.brand.name}} {{selectedModel.name}}" alt="{{selectedModel.brand.name}} {{selectedModel.name}}"
          onerror="if (this.src != 'error.jpg') this.src = 'assets/models/no-model.png'" class="model-image">
      </ion-item>

      <ion-grid slot="content" class="valuation-itens">
        <ion-row>
          <ion-col>
            <h1 class="form-title">Primeiro informe as características do seu carro</h1>
          </ion-col>
        </ion-row>

        <form [formGroup]="formOpinarCarro" (submit)="showConfirmAlert()">
          <ion-row>
            <ion-col size-lg="2" size-md="3" size-sm="12" size-xs="12">
              <ion-item>
                <ion-label position="floating">Ano modelo</ion-label>
                <ion-input type="tel" (ionInput)="onlyNumbers($event)" minlength="4" maxlength="4" formControlName="opinarAnoModelo"
                  placeholder="Ex: 2015"></ion-input>
              </ion-item>
              <ion-note color="danger" *ngIf="formOpinarCarro.controls.opinarAnoModelo.touched && formOpinarCarro.controls.opinarAnoModelo.invalid">Campo inválido</ion-note>
            </ion-col>

            <ion-col size-lg="2" size-md="3" size-sm="12" size-xs="12">
              <ion-item>
                <ion-label position="floating">Combustível</ion-label>
                <ion-select interface="popover" formControlName="opinarCombustivel">
                  <ion-select-option value="flex">Flex</ion-select-option>
                  <ion-select-option value="gasolina">Gasolina</ion-select-option>
                  <ion-select-option value="etanol">Etanol</ion-select-option>
                  <ion-select-option value="diesel">Diesel</ion-select-option>
                  <ion-select-option value="hibrido">Híbrido</ion-select-option>
                  <ion-select-option value="eletrico">Elétrico</ion-select-option>
                </ion-select>
              </ion-item>
            </ion-col>

            <ion-col size-lg="8" size-md="6" size-sm="12" size-xs="12">
              <ion-item lines="none">
                <ion-note slot="start" class="range-label"><p>Motorização</p></ion-note>
                <ion-note slot="end" color="dark" class="range-note"><h1>{{opinarMotor}}</h1></ion-note>
              </ion-item>

              <ion-range [min]="1" [max]="4.5" [step]="0.1" [value]="0" (ionChange)="changeOpinarMotor($event)"></ion-range>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-col size-lg="3" size-md="3" size-sm="4" size-xs="12">
              <ion-item>
                <ion-label position="floating">Ano da compra</ion-label>
                <ion-input type="tel" (ionInput)="onlyNumbers($event)" (ionChange)="resetOpinaPeriodo()" minlength="4" maxlength="4" max="newerYear" formControlName="opinarAnoCompra"
                  placeholder="Ex: 2017"></ion-input>
              </ion-item>
              <ion-note color="danger" *ngIf="formOpinarCarro.controls.opinarAnoCompra.touched && formOpinarCarro.controls.opinarAnoCompra.invalid">Campo inválido</ion-note>
            </ion-col>

            <ion-col size-lg="9" size-md="9" size-sm="8" size-xs="12">
              <ion-item lines="none">
                <ion-note slot="start" class="range-label"><p>Permanência com o carro</p></ion-note>
                <ion-note slot="end" color="dark" class="range-note"><h1>{{opinarPeriodo}}</h1></ion-note>
              </ion-item>

              <ion-range [min]="1" [max]="opinarPeriodoMaxValue" [value]="opinarPeriodoValue"
                  (ionChange)="changeOpinarPeriodo($event)" [disabled]="formOpinarCarro.controls.opinarAnoCompra.invalid"></ion-range>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-col size-lg="12" size-md="12" size-sm="12" size-xs="12">
              <ion-item lines="none">
                <ion-note slot="start" class="range-label"><p>Km aproximada na compra</p></ion-note>
                <ion-note slot="end" color="dark" class="range-note"><h1>{{opinarKmCompra}}</h1></ion-note>
              </ion-item>

              <ion-range [min]="0" [max]="99" [value]="0" (ionChange)="changeOpinarKmCompra($event)"></ion-range>
            </ion-col>
          </ion-row>
        </form>

        <ion-row>
          <ion-col>
            <h1 class="form-title">O que você tem a dizer sobre seu carro?</h1>
          </ion-col>
        </ion-row>

        <ion-row *ngFor="let item of valuationItens" class="valuation-row" [ngClass]="item.valuation ? 'item-'+item.valuation : 'item-medium'">
          <ion-col size-md="3" size-sm="4" size-xs="12" class="item-col-val">
            <ion-label color="dark" class="item-title"><h1>{{item.title}}</h1></ion-label>
            <ion-label class="item-subtitle"><p>{{item.subtitle}}</p></ion-label>
          </ion-col>
          <ion-col size-md="9" size-sm="8" size-xs="12">
            <ion-segment (ionChange)="segmentChanged($event)" mode="ios" color="light" [id]="item.value">
              <ion-segment-button *ngFor="let val of valuation" value="{{val.value}}" [ngClass]="val.value">
                <ion-label>{{val.name}}</ion-label>
              </ion-segment-button>
            </ion-segment>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>
  </div>
</ion-content>
